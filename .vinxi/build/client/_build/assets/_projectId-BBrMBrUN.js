import{l as B,r as f,j as t,y as Q,N as Mt,u as at,aa as nt,ab as it,B as I,aE as lt,ah as se,g as Te,ai as At,k as _,ae as z,a_ as Pe,a$ as Ut,T as ge,O as je,Q as ve,V as ye,ag as Se,Z as Oe,Y as Me,aZ as Ae,b0 as Ue,W as Lt,a3 as zt,L as ae,ad as Le,C as H,a as G,b as K,c as ne,d as X,aQ as $t,aR as _t,aS as Vt,U as ze,h as Bt,b1 as $e}from"./client-DiO1itwi.js";import{C as Wt,a as qt,b as Zt,S as V,H as Ht,M as Gt}from"./collapsible-BuqZn5if.js";import{D as Ee,a as ot,b as Ie,c as ce,d as de,e as Ne,f as ct,g as Kt}from"./dialog-CVLl7X0z.js";import{C as Jt}from"./checkbox-Djku3J0i.js";import{L as ie}from"./lock-P2tfaz_2.js";import{T as ue}from"./trash-2-BDbYwT3P.js";import{A as _e,B as Ve}from"./avatar-BAoJ5n5W.js";import{F as Be}from"./folder-open-CEY2dW8h.js";import"./plus-BMIM1RPa.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=B("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=B("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=B("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=B("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=B("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=B("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=B("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=B("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),tr=Mt("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-amber-500/50 text-amber-700 [&>svg]:text-amber-700"}},defaultVariants:{variant:"default"}}),ut=f.forwardRef(({className:e,variant:r,...a},s)=>t.jsx("div",{ref:s,role:"alert",className:Q(tr({variant:r}),e),...a}));ut.displayName="Alert";const rr=f.forwardRef(({className:e,...r},a)=>t.jsx("h5",{ref:a,className:Q("mb-1 font-medium leading-none tracking-tight",e),...r}));rr.displayName="AlertTitle";const mt=f.forwardRef(({className:e,...r},a)=>t.jsx("div",{ref:a,className:Q("text-sm [&_p]:leading-relaxed",e),...r}));mt.displayName="AlertDescription";function sr({project:e,onProjectUpdated:r,trigger:a,userId:s}){const n=at(),l=nt(it),[d,o]=f.useState(!1),[u,N]=f.useState(!1),[P,w]=f.useState(!1),[E,m]=f.useState(!1),[i,F]=f.useState(""),[j,k]=f.useState({name:"",description:"",isPrivate:!1}),[S,M]=f.useState(!0);f.useEffect(()=>{if(d){k({name:e.name||"",description:e.description||"",isPrivate:e.isPrivate||!1});const h=e.members?.length||0;M(h<=1),m(!1),F("")}},[d,e]);const L=h=>{k({...j,[h.target.name]:h.target.value})},A=h=>{k({...j,isPrivate:h})},D=async h=>{if(h.preventDefault(),!e.id){_.error("Project not found");return}if(!j.name.trim()){_.error("Project name is required");return}if(j.isPrivate&&!S&&!e.isPrivate){_.error("Cannot make a project private when it has multiple members");return}N(!0);try{const{data:C}=await z().chatrooms.updateProject(e.id,{teamspaceId:e.teamspaceId,context:e.context,creatorId:s,name:j.name,description:j.description,isPrivate:j.isPrivate,members:j.isPrivate?[]:e.members?.map(R=>({projectId:e.id,userId:R.user.id,role:R.role,invitedByUserId:s}))});r(C),_.success("Project settings updated successfully"),o(!1)}catch(C){console.error("Error updating project:",C),_.error("Failed to update project")}finally{N(!1)}},g=async()=>{if(i!==e.name){_.error("Project name does not match");return}w(!0);try{await z().chatrooms.deleteProject(e.id),_.success("Project deleted successfully"),o(!1),e.teamspaceId?(l(h=>h.map(R=>({...R,projects:R.projects.filter(p=>p.id!==e.id)}))),n({to:"/teamspace/$teamspaceId",params:{teamspaceId:e.teamspaceId}})):n({to:"/chat"})}catch(h){console.error("Error deleting project:",h),_.error("Failed to delete project")}finally{w(!1)}};return t.jsxs(Ee,{open:d,onOpenChange:o,children:[t.jsx(ot,{asChild:!0,children:a||t.jsxs(I,{size:"sm",variant:"outline",className:"hover:cursor-pointer",children:[t.jsx(lt,{className:"h-4 w-4 mr-2"})," Project Settings"]})}),t.jsx(Ie,{className:"sm:max-w-[500px]",children:E?t.jsxs("div",{children:[t.jsxs(ce,{children:[t.jsx("div",{className:"h-1.5 bg-red-500 w-full absolute top-0 left-0 rounded-t-lg"}),t.jsxs(de,{className:"text-xl mt-2 text-red-600 flex items-center",children:[t.jsx(ue,{className:"h-5 w-5 mr-2"})," Delete Project"]}),t.jsx(Ne,{children:"This action cannot be undone. This will permanently delete the project and remove all associated chats and data."})]}),t.jsxs("div",{className:"py-4",children:[t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"text-xl mr-2",children:"ðŸ’©"}),t.jsxs("p",{className:"text-sm text-red-800",children:["Are you absolutely sure you want to delete ",t.jsx("strong",{children:e.name}),"? This action is irreversible!"]})]})}),t.jsxs("div",{className:"grid gap-2",children:[t.jsxs(se,{htmlFor:"confirmName",className:"text-sm font-medium",children:["To confirm, type ",t.jsx("span",{className:"font-bold",children:e.name})," below:"]}),t.jsx(Te,{id:"confirmName",value:i,onChange:h=>F(h.target.value),placeholder:`Type "${e.name}" to confirm`})]}),t.jsxs("div",{className:"flex justify-between mt-6",children:[t.jsx(I,{type:"button",variant:"outline",onClick:()=>m(!1),disabled:P,children:"Cancel"}),t.jsx(I,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-700",onClick:g,disabled:i!==e.name||P,children:P?"Deleting...":"Permanently Delete Project"})]})]})]}):t.jsxs("form",{onSubmit:D,children:[t.jsxs(ce,{children:[t.jsx("div",{className:"h-1.5 bg-emerald-500 w-full absolute top-0 left-0 rounded-t-lg"}),t.jsx(de,{className:"text-xl mt-2",children:"Project Settings"}),t.jsx(Ne,{children:"Update the details and settings of your project"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsxs(se,{htmlFor:"name",children:["Project Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Te,{id:"name",name:"name",value:j.name,onChange:L,placeholder:"e.g. Marketing Campaign",required:!0})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(se,{htmlFor:"description",children:"Description"}),t.jsx(At,{id:"description",name:"description",value:j.description,onChange:L,placeholder:"What is this project about?",rows:3})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Jt,{id:"isPrivate",checked:j.isPrivate,onCheckedChange:A,disabled:!S&&!e.isPrivate}),t.jsxs("div",{className:"grid gap-1.5 leading-none",children:[t.jsxs(se,{htmlFor:"isPrivate",className:`text-sm font-medium leading-none flex items-center ${!S&&!e.isPrivate?"text-muted-foreground":""}`,children:[t.jsx(ie,{className:"h-3.5 w-3.5 mr-1.5 text-muted-foreground"}),"Make project private"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Private projects are only visible to invited members"})]})]}),!S&&!e.isPrivate&&t.jsxs(ut,{variant:"warning",className:"bg-amber-50 text-amber-800 border-amber-200",children:[t.jsx(dt,{className:"h-4 w-4"}),t.jsx(mt,{children:"Projects with multiple members cannot be made private"})]}),t.jsx("div",{className:"border-t pt-4 mt-2",children:t.jsxs("div",{className:"flex flex-col space-y-2",children:[t.jsx("h3",{className:"text-sm font-medium text-red-600",children:"Danger Zone"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Once you delete a project, there is no going back. This action cannot be undone."}),t.jsxs(I,{type:"button",variant:"destructive",className:"mt-2 bg-red-600 hover:bg-red-700",onClick:()=>m(!0),children:[t.jsx(ue,{className:"h-4 w-4 mr-2"})," Delete Project"]})]})})]}),t.jsxs(ct,{children:[t.jsx(Kt,{asChild:!0,children:t.jsx(I,{variant:"outline",type:"button",disabled:u,children:"Cancel"})}),t.jsx(I,{type:"submit",className:"bg-emerald-600 hover:bg-emerald-700",disabled:u,children:u?"Saving...":"Save Changes"})]})]})})]})}function ar(e,r){return`${e} returned \`undefined\`. Seems you forgot to wrap component within ${r}`}function re(e={}){const{name:r,strict:a=!0,hookName:s="useContext",providerName:n="Provider",errorMessage:l,defaultValue:d}=e,o=f.createContext(d);o.displayName=r;function u(){const N=f.useContext(o);if(!N&&a){const P=new Error(l??ar(s,n));throw P.name="ContextError",Error.captureStackTrace?.(P,u),P}return N}return[o.Provider,u,o]}function nr(e){return e?Array.isArray(e)?e:[e]:[]}function ft(e){return e.reduce((r,a)=>Array.isArray(a)?r.concat(ft(a)):r.concat(a),[])}var le=e=>typeof e=="string",te=e=>typeof e=="function",ir=Function.prototype.toString;ir.call(Object);var lr=e=>e(),ht=(...e)=>(...r)=>{e.forEach(function(a){a?.(...r)})};function pt(e){if(!or(e)||e===void 0)return e;const r=Reflect.ownKeys(e).filter(s=>typeof s=="string"),a={};for(const s of r){const n=e[s];n!==void 0&&(a[s]=pt(n))}return a}var or=e=>e&&typeof e=="object"&&e.constructor===Object;function Ze(...e){e.length===1?e[0]:e[1],e.length===2&&e[0]}function cr(e,r){if(e==null)throw new Error(r)}var he=e=>typeof e=="object"&&e!==null,O=e=>e?"":void 0,dr=1,ur=9,mr=11,be=e=>he(e)&&e.nodeType===dr&&typeof e.nodeName=="string",xt=e=>he(e)&&e.nodeType===ur,fr=e=>he(e)&&e===e.window,hr=e=>he(e)&&e.nodeType!==void 0,gt=e=>hr(e)&&e.nodeType===mr&&"host"in e;function fe(e,r){if(!e||!r||!be(e)||!be(r))return!1;const a=r.getRootNode?.();if(e===r||e.contains(r))return!0;if(a&&gt(a)){let s=r;for(;s;){if(e===s)return!0;s=s.parentNode||s.host}}return!1}function pr(e){return xt(e)?e:fr(e)?e.document:e?.ownerDocument??document}function jt(e){return gt(e)?jt(e.host):xt(e)?e.defaultView??window:be(e)?e.ownerDocument?.defaultView??window:window}function xr(e){let r=e.activeElement;for(;r?.shadowRoot;){const a=r.shadowRoot.activeElement;if(a===r)break;r=a}return r}function gr(e){return e.composedPath?.()??e.nativeEvent?.composedPath?.()}function De(e){return gr(e)?.[0]??e.target}var He=e=>fe(e.currentTarget,De(e)),Ge=(e,r,a,s)=>{const n=typeof e=="function"?e():e;return n?.addEventListener(r,a,s),()=>{n?.removeEventListener(r,a,s)}};function jr(e){let r;const a=globalThis.requestAnimationFrame(()=>{r=e()});return()=>{globalThis.cancelAnimationFrame(a),r?.()}}var vr={border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"},yr=(...e)=>e.map(r=>r?.trim?.()).filter(Boolean).join(" "),Nr=/((?:--)?(?:\w+-?)+)\s*:\s*([^;]*)/g,Ke=e=>{const r={};let a;for(;a=Nr.exec(e);)r[a[1]]=a[2];return r},br=(e,r)=>{if(le(e)){if(le(r))return`${e};${r}`;e=Ke(e)}else le(r)&&(r=Ke(r));return Object.assign({},e??{},r??{})};function $(...e){let r={};for(let a of e){for(let s in r){if(s.startsWith("on")&&typeof r[s]=="function"&&typeof a[s]=="function"){r[s]=ht(a[s],r[s]);continue}if(s==="className"||s==="class"){r[s]=yr(r[s],a[s]);continue}if(s==="style"){r[s]=br(r[s],a[s]);continue}r[s]=a[s]!==void 0?a[s]:r[s]}for(let s in a)r[s]===void 0&&(r[s]=a[s])}return r}var Y=(e=>(e.NotStarted="Not Started",e.Started="Started",e.Stopped="Stopped",e))(Y||{}),pe="__init__";function wr(e){const r=()=>e.getRootNode?.()??document,a=()=>pr(r()),s=()=>a().defaultView??window,n=()=>xr(r());return{...e,getRootNode:r,getDoc:a,getWin:s,getActiveElement:n,isActiveElement:o=>o===n(),getById:o=>r().getElementById(o)}}function Fr(e){return new Proxy({},{get(r,a){return a==="style"?s=>e({style:s}).style:e}})}var vt=()=>e=>Array.from(new Set(e)),yt=typeof globalThis.document<"u"?f.useLayoutEffect:f.useEffect;function Je(e){const r=e().value??e().defaultValue,a=e().isEqual??Object.is,[s]=f.useState(r),[n,l]=f.useState(s),d=e().value!==void 0,o=f.useRef(n);o.current=d?e().value:n;const u=f.useRef(o.current);yt(()=>{u.current=o.current},[n,e().value]);const N=w=>{const E=u.current,m=te(w)?w(E):w;e().debug&&console.log(`[bindable > ${e().debug}] setValue`,{next:m,prev:E}),d||l(m),a(m,E)||e().onChange?.(m,E)};function P(){return d?e().value:n}return{initial:s,ref:o,get:P,set(w){(e().sync?Pe.flushSync:lr)(()=>N(w))},invoke(w,E){e().onChange?.(w,E)},hash(w){return e().hash?.(w)??String(w)}}}function Cr(e){const r=f.useRef(e);return{get(a){return r.current[a]},set(a,s){r.current[a]=s}}}var Pr=(e,r)=>{const a=f.useRef(!1),s=f.useRef(!1);f.useEffect(()=>{if(a.current&&s.current)return r();s.current=!0},[...(e??[]).map(n=>typeof n=="function"?n():n)]),f.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[])};function Er(e,r={}){const a=f.useMemo(()=>{const{id:p,ids:x,getRootNode:b}=r;return wr({id:p,ids:x,getRootNode:b})},[r]),s=(...p)=>{e.debug&&console.log(...p)},n=e.props?.({props:pt(r),scope:a})??r,l=Ir(n),d=e.context?.({prop:l,bindable:Je,scope:a,flush:Ye,getContext(){return u},getComputed(){return A},getRefs(){return F}}),o=Nt(d),u={get(p){return o.current?.[p].ref.current},set(p,x){o.current?.[p].set(x)},initial(p){return o.current?.[p].initial},hash(p){const x=o.current?.[p].get();return o.current?.[p].hash(x)}},N=f.useRef(new Map),P=f.useRef(null),w=f.useRef(null),E=f.useRef({type:""}),m=()=>({...E.current,current(){return E.current},previous(){return w.current}}),i=()=>({...D,matches(...p){return p.includes(D.ref.current)},hasTag(p){return!!e.states[D.ref.current]?.tags?.includes(p)}}),F=Cr(e.refs?.({prop:l,context:u})??{}),j=()=>({state:i(),context:u,event:m(),prop:l,send:R,action:k,guard:S,track:Pr,refs:F,computed:A,flush:Ye,scope:a,choose:L}),k=p=>{const x=te(p)?p(j()):p;if(!x)return;const b=x.map(c=>{const v=e.implementations?.actions?.[c];return v||Ze(`[zag-js] No implementation found for action "${JSON.stringify(c)}"`),v});for(const c of b)c?.(j())},S=p=>te(p)?p(j()):e.implementations?.guards?.[p](j()),M=p=>{const x=te(p)?p(j()):p;if(!x)return;const b=x.map(v=>{const y=e.implementations?.effects?.[v];return y||Ze(`[zag-js] No implementation found for effect "${JSON.stringify(v)}"`),y}),c=[];for(const v of b){const y=v?.(j());y&&c.push(y)}return()=>c.forEach(v=>v?.())},L=p=>nr(p).find(x=>{let b=!x.guard;return le(x.guard)?b=!!S(x.guard):te(x.guard)&&(b=x.guard(j())),b}),A=p=>{cr(e.computed,"[zag-js] No computed object found on machine");const x=e.computed[p];return x({context:u,event:m(),prop:l,refs:F,scope:a,computed:A})},D=Je(()=>({defaultValue:e.initialState({prop:l}),onChange(p,x){x&&(N.current.get(x)?.(),N.current.delete(x)),x&&k(e.states[x]?.exit),k(P.current?.actions);const b=M(e.states[p]?.effects);if(b&&N.current.set(p,b),x===pe){k(e.entry);const c=M(e.effects);c&&N.current.set(pe,c)}k(e.states[p]?.entry)}})),g=f.useRef(void 0),h=f.useRef(Y.NotStarted);yt(()=>{queueMicrotask(()=>{const b=h.current===Y.Started;h.current=Y.Started,s(b?"rehydrating...":"initializing...");const c=g.current??D.initial;D.invoke(c,b?D.get():pe)});const p=N.current,x=D.ref.current;return()=>{s("unmounting..."),g.current=x,h.current=Y.Stopped,p.forEach(b=>b?.()),N.current=new Map,P.current=null,queueMicrotask(()=>{k(e.exit)})}},[]);const C=()=>"ref"in D?D.ref.current:D.get(),R=p=>{queueMicrotask(()=>{if(h.current!==Y.Started)return;w.current=E.current,E.current=p,s("send",p);let x=C();const b=e.states[x].on?.[p.type]??e.on?.[p.type],c=L(b);if(!c)return;P.current=c;const v=c.target??x;s("transition",c);const y=v!==x;y?Pe.flushSync(()=>D.set(v)):c.reenter&&!y?D.invoke(x,x):k(c.actions??[])})};return e.watch?.(j()),{state:i(),send:R,context:u,prop:l,scope:a,refs:F,computed:A,event:m(),getStatus:()=>h.current}}function Nt(e){const r=f.useRef(e);return r.current=e,r}function Ir(e){const r=Nt(e);return function(s){return r.current[s]}}function Ye(e){queueMicrotask(()=>{Pe.flushSync(()=>e())})}var Dr=Fr(e=>e);function kr(...e){return r=>{const a=[];for(const s of e)if(typeof s=="function"){const n=s(r);typeof n=="function"&&a.push(n)}else s&&(s.current=r);if(a.length)return()=>{for(const s of a)s()}}}function Rr(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?e.props.ref:e.props.ref||e.ref)}const xe=e=>{const r=f.memo(f.forwardRef((a,s)=>{const{asChild:n,children:l,...d}=a;if(!n)return f.createElement(e,{...d,ref:s},l);const o=f.Children.only(l);if(!f.isValidElement(o))return null;const u=Rr(o);return f.cloneElement(o,{...$(d,o.props),ref:s?kr(s,u):u})}));return r.displayName=e.displayName||e.name,r},Tr=()=>{const e=new Map;return new Proxy(xe,{apply(r,a,s){return xe(s[0])},get(r,a){const s=a;return e.has(s)||e.set(s,xe(s)),e.get(s)}})},W=Tr(),ke=()=>(e,r)=>r.reduce((a,s)=>{const[n,l]=a,d=s;return l[d]!==void 0&&(n[d]=l[d]),delete l[d],[n,l]},[{},{...e}]);var oe=(e,r=[])=>({parts:(...a)=>{if(Sr(r))return oe(e,a);throw new Error("createAnatomy().parts(...) should only be called once. Did you mean to use .extendWith(...) ?")},extendWith:(...a)=>oe(e,[...r,...a]),rename:a=>oe(a,r),keys:()=>r,build:()=>[...new Set(r)].reduce((a,s)=>Object.assign(a,{[s]:{selector:[`&[data-scope="${J(e)}"][data-part="${J(s)}"]`,`& [data-scope="${J(e)}"][data-part="${J(s)}"]`].join(", "),attrs:{"data-scope":J(e),"data-part":J(s)}}}),{})}),J=e=>e.replace(/([A-Z])([A-Z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),Sr=e=>e.length===0;const[Cs,Or]=re({name:"EnvironmentContext",hookName:"useEnvironmentContext",providerName:"<EnvironmentProvider />",strict:!1,defaultValue:{getRootNode:()=>document,getDocument:()=>document,getWindow:()=>window}}),[Ps,Mr]=re({name:"LocaleContext",hookName:"useLocaleContext",providerName:"<LocaleProvider />",strict:!1,defaultValue:{dir:"ltr",locale:"en-US"}}),[Es,bt]=re({name:"FieldContext",hookName:"useFieldContext",providerName:"<FieldProvider />",strict:!1});var Ar=e=>typeof e.getAsEntry=="function"?e.getAsEntry():typeof e.webkitGetAsEntry=="function"?e.webkitGetAsEntry():null,wt=e=>e.isDirectory,Ft=e=>e.isFile,Ct=(e,r)=>(Object.defineProperty(e,"relativePath",{value:r?`${r}/${e.name}`:e.name}),e),Ur=(e,r)=>Promise.all(Array.from(e).filter(a=>a.kind==="file").map(a=>{const s=Ar(a);if(!s)return null;if(wt(s)&&r)return Pt(s.createReader(),`${s.name}`);if(Ft(s))return new Promise(n=>{s.file(l=>{n(Ct(l,""))})})}).filter(a=>a)),Pt=(e,r="")=>new Promise(a=>{const s=[],n=()=>{e.readEntries(l=>{if(l.length===0){a(Promise.all(s).then(o=>o.flat()));return}const d=l.map(o=>{if(!o)return null;if(wt(o))return Pt(o.createReader(),`${r}${o.name}`);if(Ft(o))return new Promise(u=>{o.file(N=>{u(Ct(N,r))})})}).filter(o=>o);s.push(Promise.all(d)),n()})};n()});function Lr(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function zr(e){return/^.*\.[\w]+$/.test(e)}var Qe=e=>Lr(e)||zr(e);function $r(e){if(e!=null)return typeof e=="string"?e:Array.isArray(e)?e.filter(Qe).join(","):Object.entries(e).reduce((r,[a,s])=>[...r,a,...s],[]).filter(Qe).join(",")}var Xe=(e,r)=>e.name===r.name&&e.size===r.size&&e.type===r.type,ee=e=>e!=null;function _r(e,r,a){if(ee(e.size))if(ee(r)&&ee(a)){if(e.size>a)return[!1,"FILE_TOO_LARGE"];if(e.size<r)return[!1,"FILE_TOO_SMALL"]}else{if(ee(r)&&e.size<r)return[!1,"FILE_TOO_SMALL"];if(ee(a)&&e.size>a)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}function Vr(e,r){if(e&&r){const a=Array.isArray(r)?r:typeof r=="string"?r.split(","):[];if(a.length===0)return!0;const s=e.name||"",n=(e.type||"").toLowerCase(),l=n.replace(/\/.*$/,"");return a.some(d=>{const o=d.trim().toLowerCase();return o.charAt(0)==="."?s.toLowerCase().endsWith(o):o.endsWith("/*")?l===o.replace(/\/.*$/,""):n===o})}return!0}function Br(e,r){const a=e.type==="application/x-moz-file"||Vr(e,r);return[a,a?null:"FILE_INVALID_TYPE"]}const[Wr,q]=re({name:"FileUploadContext",hookName:"useFileUploadContext",providerName:"<FileUploadProvider />"}),qr=e=>e.children(q()),Et=f.forwardRef((e,r)=>{const[a,s]=ke()(e,["disableClick"]),n=q(),l=$(n.getDropzoneProps(a),s);return t.jsx(W.div,{...l,ref:r})});Et.displayName="FileUploadDropzone";const It=f.forwardRef((e,r)=>{const a=q(),s=$(a.getHiddenInputProps(),e),n=bt();return t.jsx(W.input,{"aria-describedby":n?.ariaDescribedby,...s,ref:r})});It.displayName="FileUploadHiddenInput";const[Zr,Re]=re({name:"FileUploadItemPropsContext",hookName:"useFileUploadItemPropsContext",providerName:"<FileUploadItemPropsProvider />"}),Dt=f.forwardRef((e,r)=>{const[a,s]=ke()(e,["file"]),n=q(),l=$(n.getItemProps(a),s);return t.jsx(Zr,{value:a,children:t.jsx(W.li,{...l,ref:r})})});Dt.displayName="FileUploadItem";const kt=f.forwardRef((e,r)=>{const a=q(),s=Re(),n=$(a.getItemDeleteTriggerProps(s),e);return t.jsx(W.button,{...n,ref:r})});kt.displayName="FileUploadItemDeleteTrigger";const we=f.forwardRef((e,r)=>{const a=q(),s=Re(),n=$(a.getItemPreviewProps(s),e);return s.file.type.match(e.type??".*")?t.jsx(W.div,{...n,ref:r}):null});we.displayName="FileUploadItemPreview";const Rt=f.forwardRef((e,r)=>{const[a,s]=f.useState(""),n=q(),l=Re(),d=$(n.getItemPreviewImageProps({...l,url:a}),e);return f.useEffect(()=>n.createFileUrl(l.file,o=>s(o)),[l,n]),a?t.jsx(W.img,{...d,ref:r}):null});Rt.displayName="FileUploadItemPreviewImage";function Hr(e){const r=new Map;return function(s,n){const l=s+(n?Object.entries(n).sort((o,u)=>o[0]<u[0]?-1:1).join():"");if(r.has(l))return r.get(l);let d=new e(s,n);return r.set(l,d),d}}var Gr=Hr(Intl.NumberFormat);function Kr(e,r,a={}){return Gr(r,a).format(e)}var Jr=["","kilo","mega","giga","tera"],Yr=["","kilo","mega","giga","tera","peta"],Qr=(e,r="en-US",a={})=>{if(isNaN(e))return"";if(e===0)return"0 B";const{unit:s="byte",unitDisplay:n="short"}=a,l=s==="bit"?Jr:Yr,d=Math.max(0,Math.min(Math.floor(Math.log10(e)/3),l.length-1)),o=l[d]+s,u=n||"short",N=parseFloat((e/Math.pow(1e3,d)).toPrecision(3));return Kr(N,r,{style:"unit",unit:o,unitDisplay:u})},Xr=oe("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger"),U=Xr.build(),Tt=e=>e.ids?.root??`file:${e.id}`,St=e=>e.ids?.dropzone??`file:${e.id}:dropzone`,Fe=e=>e.ids?.hiddenInput??`file:${e.id}:input`,es=e=>e.ids?.trigger??`file:${e.id}:trigger`,ts=e=>e.ids?.label??`file:${e.id}:label`,rs=(e,r)=>e.ids?.item?.(r)??`file:${e.id}:item:${r}`,ss=(e,r)=>e.ids?.itemName?.(r)??`file:${e.id}:item-name:${r}`,as=(e,r)=>e.ids?.itemSizeText?.(r)??`file:${e.id}:item-size:${r}`,ns=(e,r)=>e.ids?.itemPreview?.(r)??`file:${e.id}:item-preview:${r}`,is=e=>e.getById(Tt(e)),et=e=>e.getById(Fe(e)),ls=e=>e.getById(St(e));function tt(e){const r=De(e);return e.dataTransfer?e.dataTransfer.types.some(a=>a==="Files"||a==="application/x-moz-file"):!!r&&"files"in r}function os(e,r){const{context:a,prop:s,computed:n}=e;return!n("multiple")&&r>1?!1:!n("multiple")&&r+a.get("acceptedFiles").length===2?!0:!(r+a.get("acceptedFiles").length>s("maxFiles"))}function cs(e,r){const{context:a,prop:s,computed:n}=e,l=[],d=[];return r.forEach(o=>{const[u,N]=Br(o,n("acceptAttr")),[P,w]=_r(o,s("minFileSize"),s("maxFileSize")),E=s("validate")?.(o,{acceptedFiles:a.get("acceptedFiles"),rejectedFiles:a.get("rejectedFiles")}),m=E?E.length===0:!0;if(u&&P&&m)l.push(o);else{const i=[N,w];m||i.push(...E??[]),d.push({file:o,errors:i.filter(Boolean)})}}),os(e,l.length)||(l.forEach(o=>{d.push({file:o,errors:["TOO_MANY_FILES"]})}),l.splice(0)),{acceptedFiles:l,rejectedFiles:d}}function ds(e,r){const a=jt(e);try{if("DataTransfer"in a){const s=new a.DataTransfer;r.forEach(n=>{s.items.add(n)}),e.files=s.files}}catch{}}function us(e,r){const{state:a,send:s,prop:n,computed:l,scope:d,context:o}=e,u=n("disabled"),N=n("allowDrop"),P=n("translations"),w=a.matches("dragging"),E=a.matches("focused")&&!u;return{dragging:w,focused:E,disabled:!!u,openFilePicker(){u||s({type:"OPEN"})},deleteFile(m){s({type:"FILE.DELETE",file:m})},acceptedFiles:o.get("acceptedFiles"),rejectedFiles:o.get("rejectedFiles"),setFiles(m){const i=m.length;s({type:"FILES.SET",files:m,count:i})},clearRejectedFiles(){s({type:"REJECTED_FILES.CLEAR"})},clearFiles(){s({type:"FILES.CLEAR"})},getFileSize(m){return Qr(m.size,n("locale"))},createFileUrl(m,i){const F=d.getWin(),j=F.URL.createObjectURL(m);return i(j),()=>F.URL.revokeObjectURL(j)},setClipboardFiles(m){if(u)return!1;const F=Array.from(m?.items??[]).reduce((j,k)=>{if(k.kind!=="file")return j;const S=k.getAsFile();return S?[...j,S]:j},[]);return F.length?(s({type:"FILES.SET",files:F}),!0):!1},getRootProps(){return r.element({...U.root.attrs,dir:n("dir"),id:Tt(d),"data-disabled":O(u),"data-dragging":O(w)})},getDropzoneProps(m={}){return r.element({...U.dropzone.attrs,dir:n("dir"),id:St(d),tabIndex:u||m.disableClick?void 0:0,role:m.disableClick?"application":"button","aria-label":P.dropzone,"aria-disabled":u,"data-invalid":O(n("invalid")),"data-disabled":O(u),"data-dragging":O(w),onKeyDown(i){u||i.defaultPrevented||He(i)&&(m.disableClick||i.key!=="Enter"&&i.key!==" "||s({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(i){u||i.defaultPrevented||m.disableClick||He(i)&&(i.currentTarget.localName==="label"&&i.preventDefault(),s({type:"DROPZONE.CLICK"}))},onDragOver(i){if(u||!N)return;i.preventDefault(),i.stopPropagation();try{i.dataTransfer.dropEffect="copy"}catch{}if(!tt(i))return;const j=i.dataTransfer.items.length;s({type:"DROPZONE.DRAG_OVER",count:j})},onDragLeave(i){u||N&&(fe(i.currentTarget,i.relatedTarget)||s({type:"DROPZONE.DRAG_LEAVE"}))},onDrop(i){if(u)return;N&&(i.preventDefault(),i.stopPropagation());const F=tt(i);u||!F||Ur(i.dataTransfer.items,n("directory")).then(j=>{s({type:"DROPZONE.DROP",files:ft(j)})})},onFocus(){u||s({type:"DROPZONE.FOCUS"})},onBlur(){u||s({type:"DROPZONE.BLUR"})}})},getTriggerProps(){return r.button({...U.trigger.attrs,dir:n("dir"),id:es(d),disabled:u,"data-disabled":O(u),"data-invalid":O(n("invalid")),type:"button",onClick(m){u||(fe(ls(d),m.currentTarget)&&m.stopPropagation(),s({type:"OPEN"}))}})},getHiddenInputProps(){return r.input({id:Fe(d),tabIndex:-1,disabled:u,type:"file",required:n("required"),capture:n("capture"),name:n("name"),accept:l("acceptAttr"),webkitdirectory:n("directory")?"":void 0,multiple:l("multiple")||n("maxFiles")>1,onClick(m){m.stopPropagation(),m.currentTarget.value=""},onInput(m){if(u)return;const{files:i}=m.currentTarget;s({type:"FILES.SET",files:i?Array.from(i):[]})},style:vr})},getItemGroupProps(){return r.element({...U.itemGroup.attrs,dir:n("dir"),"data-disabled":O(u)})},getItemProps(m){const{file:i}=m;return r.element({...U.item.attrs,dir:n("dir"),id:rs(d,i.name),"data-disabled":O(u)})},getItemNameProps(m){const{file:i}=m;return r.element({...U.itemName.attrs,dir:n("dir"),id:ss(d,i.name),"data-disabled":O(u)})},getItemSizeTextProps(m){const{file:i}=m;return r.element({...U.itemSizeText.attrs,dir:n("dir"),id:as(d,i.name),"data-disabled":O(u)})},getItemPreviewProps(m){const{file:i}=m;return r.element({...U.itemPreview.attrs,dir:n("dir"),id:ns(d,i.name),"data-disabled":O(u)})},getItemPreviewImageProps(m){const{file:i,url:F}=m;if(!i.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return r.img({...U.itemPreviewImage.attrs,alt:P.itemPreview?.(i),src:F,"data-disabled":O(u)})},getItemDeleteTriggerProps(m){const{file:i}=m;return r.button({...U.itemDeleteTrigger.attrs,dir:n("dir"),type:"button",disabled:u,"data-disabled":O(u),"aria-label":P.deleteFile?.(i),onClick(){u||s({type:"FILE.DELETE",file:i})}})},getLabelProps(){return r.label({...U.label.attrs,dir:n("dir"),id:ts(d),htmlFor:Fe(d),"data-disabled":O(u)})},getClearTriggerProps(){return r.button({...U.clearTrigger.attrs,dir:n("dir"),type:"button",disabled:u,hidden:o.get("acceptedFiles").length===0,"data-disabled":O(u),onClick(m){m.defaultPrevented||u||s({type:"FILES.CLEAR"})}})}}}var ms={props({props:e}){return{minFileSize:0,maxFileSize:Number.POSITIVE_INFINITY,maxFiles:1,allowDrop:!0,preventDocumentDrop:!0,...e,translations:{dropzone:"dropzone",itemPreview:r=>`preview of ${r.name}`,deleteFile:r=>`delete file ${r.name}`,...e.translations}}},initialState(){return"idle"},context({prop:e,bindable:r,getContext:a}){return{acceptedFiles:r(()=>({defaultValue:[],isEqual:(s,n)=>s.length===n?.length&&s.every((l,d)=>Xe(l,n[d])),hash(s){return s.map(n=>`${n.name}-${n.size}`).join(",")},onChange(s){const n=a();e("onFileAccept")?.({files:s}),e("onFileChange")?.({acceptedFiles:s,rejectedFiles:n.get("rejectedFiles")})}})),rejectedFiles:r(()=>({defaultValue:[],isEqual:(s,n)=>s.length===n?.length&&s.every((l,d)=>Xe(l.file,n[d].file)),onChange(s){const n=a();e("onFileReject")?.({files:s}),e("onFileChange")?.({acceptedFiles:n.get("acceptedFiles"),rejectedFiles:s})}}))}},computed:{acceptAttr:({prop:e})=>$r(e("accept")),multiple:({prop:e})=>e("maxFiles")>1},watch({track:e,context:r,action:a}){e([()=>r.hash("acceptedFiles")],()=>{a(["syncInputElement"])})},on:{"FILES.SET":{actions:["setFilesFromEvent"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},effects:["preventDocumentDrop"],states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":{target:"focused"},"DROPZONE.DRAG_OVER":{target:"dragging"}}},focused:{on:{"DROPZONE.BLUR":{target:"idle"},OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":{target:"dragging"}}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["setFilesFromEvent"]},"DROPZONE.DRAG_LEAVE":{target:"idle"}}}},implementations:{effects:{preventDocumentDrop({prop:e,scope:r}){if(!e("preventDocumentDrop")||!e("allowDrop")||e("disabled"))return;const a=r.getDoc(),s=l=>{l?.preventDefault()},n=l=>{fe(is(r),De(l))||l.preventDefault()};return ht(Ge(a,"dragover",s,!1),Ge(a,"drop",n,!1))}},actions:{syncInputElement({scope:e,context:r}){queueMicrotask(()=>{const a=et(e);if(!a)return;ds(a,r.get("acceptedFiles"));const s=e.getWin();a.dispatchEvent(new s.Event("change",{bubbles:!0}))})},openFilePicker({scope:e}){jr(()=>{et(e)?.click()})},setFilesFromEvent(e){const{computed:r,context:a,event:s}=e,n=cs(e,s.files),{acceptedFiles:l,rejectedFiles:d}=n;if(r("multiple")){a.set("acceptedFiles",o=>[...o,...l]),a.set("rejectedFiles",d);return}if(l.length){const o=[l[0]];a.set("acceptedFiles",o),a.set("rejectedFiles",d)}else d.length&&(a.set("acceptedFiles",a.get("acceptedFiles")),a.set("rejectedFiles",d))},removeFile({context:e,event:r}){const a=e.get("acceptedFiles").filter(n=>n!==r.file),s=e.get("rejectedFiles").filter(n=>n.file!==r.file);e.set("acceptedFiles",a),e.set("rejectedFiles",s)},clearRejectedFiles({context:e}){e.set("acceptedFiles",e.get("acceptedFiles")),e.set("rejectedFiles",[])},clearFiles({context:e}){e.set("acceptedFiles",[]),e.set("rejectedFiles",[])}}}};vt()(["accept","allowDrop","capture","dir","directory","disabled","getRootNode","id","ids","locale","maxFiles","maxFileSize","minFileSize","name","invalid","onFileAccept","onFileReject","onFileChange","preventDocumentDrop","required","translations","validate"]);vt()(["file"]);const fs=e=>{const r=f.useId(),{getRootNode:a}=Or(),{dir:s,locale:n}=Mr(),l=bt(),d={id:r,ids:{label:l?.ids.label,hiddenInput:l?.ids.control},dir:s,disabled:l?.disabled,locale:n,required:l?.required,invalid:l?.invalid,getRootNode:a,...e},o=Er(ms,d);return us(o,Dr)},Ot=f.forwardRef((e,r)=>{const[{value:a},s]=ke()(e,["value"]),n=$(a.getRootProps(),s);return t.jsx(Wr,{value:a,children:t.jsx(W.div,{...n,ref:r})})});Ot.displayName="FileUploadRootProvider";const Ce=f.forwardRef((e,r)=>{const a=q(),s=$(a.getTriggerProps(),e);return t.jsx(W.button,{...s,ref:r})});Ce.displayName="FileUploadTrigger";const rt=({teamspaceId:e=null,projectId:r=null,chatroomId:a=null,organizationId:s,receiverIds:n=[],onUploadComplete:l,compact:d=!1,files:o=[],className:u=""})=>{const[N,P]=f.useState(!1),[w,E]=f.useState(!1),[m,i]=f.useState(!1),[F,j]=f.useState([]),k=fs({maxFiles:10,maxFileSize:50*1024*1024}),S=h=>{const C=h.type;return C.startsWith("image/")||C.startsWith("video/")||C.startsWith("audio/")?"MEDIA":"DOCUMENT"},M=()=>{k.clearFiles(),E(!1),i(!1),j([])},L=h=>{P(h),h||M()},A=h=>{if(h===0)return"0 Bytes";const C=1024,R=["Bytes","KB","MB","GB"],p=Math.floor(Math.log(h)/Math.log(C));return parseFloat((h/Math.pow(C,p)).toFixed(1))+" "+R[p]},D=(h,C=28)=>{if(!h)return"";if(h.length<=C)return h;const R=h.split(".").pop()||"",p=h.substring(0,h.length-R.length-1);return p.length<=C-6?h:`${p.substring(0,C-6-R.length)}...${R.length>0?"."+R:""}`},g=async h=>{if(!h.length||!s)return;E(!0),i(!1);const C=h.map(async x=>{try{const b=new FormData,c=S(x),v={teamspaceId:e||null,projectId:r||null,chatroomId:a||null,organizationId:s,uploadType:c};b.append("metadata",JSON.stringify(v)),n.length>0&&b.append("receiverIds",JSON.stringify(n)),b.append("file",x);const y=await z().fileManagement.uploadFilesWithMetadata("POST",b);if(!y.ok)throw new Error(`Upload failed for ${x.name}: ${y.statusText} (${y.status})`);return console.log(`Upload successful for: ${x.name}`),{success:!0,fileName:x.name,fileSize:x.size,fileType:x.type,uploadType:c}}catch(b){return console.error(`Error uploading file ${x.name}:`,b instanceof Error?b.message:String(b)),{success:!1,fileName:x.name,error:b instanceof Error?b.message:String(b)}}}),R=await Promise.allSettled(C),p=R.filter(x=>x.status==="fulfilled"&&x.value.success===!0).map(x=>x.value);R.filter(x=>x.status==="rejected"||x.status==="fulfilled"&&!x.value.success),j(p),E(!1),i(!0),l&&p.length>0&&l(p)};return t.jsxs(Ee,{open:N,onOpenChange:L,children:[t.jsx(ot,{asChild:!0,children:t.jsxs(I,{variant:"outline",size:d?"sm":"default",className:Q("text-emerald-600 border-emerald-200 hover:bg-emerald-50",u),children:[t.jsx(We,{className:Q("mr-2",d?"h-4 w-4":"h-5 w-5")}),"Upload"]})}),t.jsxs(Ie,{className:"sm:max-w-md w-[95vw] max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsx(ce,{className:"flex-shrink-0",children:t.jsx(de,{children:"Upload Files"})}),t.jsx("div",{className:"py-4 flex-1 overflow-y-auto",children:t.jsx(Ot,{value:k,children:t.jsxs("div",{className:"w-full",children:[t.jsx(qr,{children:h=>t.jsxs(t.Fragment,{children:[h.acceptedFiles.length===0&&!m&&t.jsx(Et,{className:"border-2 border-dashed border-gray-300 rounded-lg text-center p-4 sm:p-8 bg-gray-50 hover:bg-gray-100 transition-colors",children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(We,{className:"h-10 w-10 sm:h-12 sm:w-12 text-emerald-500 mb-3"}),t.jsx("p",{className:"text-gray-700 font-medium mb-1",children:"Drag and drop files here"}),t.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"or"}),t.jsx(Ce,{asChild:!0,children:t.jsx(I,{children:"Choose Files"})})]})}),h.acceptedFiles.length>0&&!w&&!m&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"border rounded-md",children:t.jsx("div",{className:"max-h-[30vh] overflow-y-auto space-y-1 px-2 py-2",children:h.acceptedFiles.map(C=>t.jsxs(Dt,{file:C,className:"flex items-center p-2 rounded hover:bg-gray-50 transition-colors",children:[t.jsx(we,{type:"image/*",className:"w-10 h-10 min-w-[2.5rem] mr-3 bg-gray-100 flex items-center justify-center rounded overflow-hidden",children:t.jsx(Rt,{className:"max-w-full max-h-full object-cover"})}),t.jsx(we,{type:".*",className:"w-10 h-10 min-w-[2.5rem] mr-3 bg-gray-100 flex items-center justify-center rounded",children:t.jsx(me,{className:"h-5 w-5 text-gray-500"})}),t.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[t.jsx("div",{className:"font-medium text-sm truncate",title:C.name,children:D(C.name)}),t.jsx("div",{className:"text-xs text-gray-500",children:A(C.size)})]}),t.jsx(kt,{className:"ml-1 text-red-500 hover:text-red-700 p-1 flex-shrink-0",children:t.jsx(ue,{className:"h-4 w-4"})})]},`${C.name}-${C.size}`))})}),t.jsxs("div",{className:"flex flex-col space-y-2",children:[t.jsxs(I,{onClick:()=>g(h.acceptedFiles),className:"w-full",children:[t.jsx(Ut,{className:"h-4 w-4 mr-2"}),"Upload ",h.acceptedFiles.length," File",h.acceptedFiles.length!==1?"s":""]}),t.jsx("div",{className:"text-center",children:t.jsxs(Ce,{className:"text-xs text-emerald-600 hover:underline inline-flex items-center",children:[t.jsx("span",{className:"mr-1",children:"+"}),"Add More Files"]})})]})]}),w&&t.jsxs("div",{className:"py-8 flex flex-col items-center justify-center",children:[t.jsxs("div",{className:"w-16 h-16 relative mb-4",children:[t.jsx("div",{className:"w-full h-full rounded-full border-4 border-emerald-100 animate-pulse"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsxs("svg",{className:"animate-spin h-8 w-8 text-emerald-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),t.jsx("p",{className:"font-medium text-gray-700",children:"Uploading files..."}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Please wait while your files are being uploaded"})]}),m&&t.jsxs("div",{className:"py-8 flex flex-col items-center justify-center",children:[t.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mb-4",children:t.jsx(Yt,{className:"h-8 w-8 text-emerald-600"})}),t.jsx("p",{className:"font-medium text-gray-700",children:"Upload Complete!"}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1 mb-4",children:["Successfully uploaded ",F.length," file",F.length!==1?"s":""]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx(I,{onClick:()=>{M(),P(!1)},variant:"outline",children:"Close"}),t.jsx(I,{onClick:()=>{M()},children:"Upload More Files"})]})]})]})}),t.jsx(It,{})]})})})]})]})},hs=e=>{if(!e||!e.fileType)return t.jsx("div",{className:"flex items-center justify-center h-full w-full bg-gray-200",children:t.jsx(me,{className:"h-4 w-4 text-gray-500"})});switch(e.fileType){case"IMAGE":return t.jsx("div",{className:"relative w-full h-full bg-gray-100 overflow-hidden",children:t.jsx("img",{src:e.fileUrl||"",alt:e.fileName||"Image preview",className:"h-full w-full object-cover",loading:"lazy",onError:r=>{r.target.outerHTML='<div class="flex items-center justify-center h-full w-full bg-gray-200 text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-image-off"><path d="M8.5 10.5c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5Z"/><path d="M21 15l-5-5L5 21"/><path d="m2 2 20 20"/><path d="M14.5 4.5h6v6"/><path d="M17 11.5a5 5 0 1 0-8-4"/></svg></div>'}})});case"VIDEO":return t.jsx("div",{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 h-full w-full flex items-center justify-center",children:t.jsx(Qt,{className:"h-4 w-4 text-indigo-500"})});case"AUDIO":return t.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 h-full w-full flex items-center justify-center",children:t.jsx(er,{className:"h-4 w-4 text-purple-500"})});case"PDF":return t.jsx("div",{className:"bg-gradient-to-br from-red-50 to-red-100 h-full w-full flex items-center justify-center",children:t.jsx(Ae,{className:"h-4 w-4 text-red-500"})});case"DOCUMENT":return t.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 h-full w-full flex items-center justify-center",children:t.jsx(Ae,{className:"h-4 w-4 text-blue-500"})});case"FILE":default:return t.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 h-full w-full flex items-center justify-center",children:t.jsx(me,{className:"h-4 w-4 text-gray-500"})})}},st=e=>{switch(e){case"OWNER":return"bg-green-100 text-green-800 border-green-200";case"ADMIN":return"bg-red-100 text-red-800 border-red-200";case"CONTRIBUTOR":return"bg-blue-100 text-blue-800 border-blue-200";case"VIEWER":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},ps=({members:e})=>{const[r,a]=f.useState(!1),[s,n]=f.useState(!1),l=5,d=e.filter((i,F,j)=>F===j.findIndex(k=>k.user?.id===i.user?.id)),o=d.filter(i=>!i.hasLeft),u=d.filter(i=>i.hasLeft),N=(i,F)=>{const j={OWNER:0,ADMIN:1,CONTRIBUTOR:2,VIEWER:3};return(j[i.role]||4)-(j[F.role]||4)},P=[...o].sort(N),w=[...u].sort(N),E=r?P:P.slice(0,o.length>=l?l:o.length),m=o.length>l&&!r;return t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{children:E.map(i=>t.jsx("div",{className:"py-1.5",children:t.jsxs("div",{className:"relative flex items-center justify-between group",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(_e,{className:"h-7 w-7",children:i.user?.image?t.jsx("img",{src:i.user.image,alt:i.user?.name||"User"}):t.jsx("div",{className:"bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 text-xs",children:(i.user?.name||"U").charAt(0)})}),t.jsx(ge,{children:t.jsxs(je,{children:[t.jsx(ve,{asChild:!0,children:t.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",children:i.user?.name||"Unknown User"})}),t.jsxs(ye,{children:[t.jsx("p",{children:i.user?.name||"Unknown User"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:i.user?.email})]})]})})]}),t.jsx(Se,{className:st(i.role),children:i.role})]})},i.id))}),m&&t.jsx(I,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>a(!0),children:t.jsxs("span",{className:"flex items-center",children:["Show ",o.length-l," More ",t.jsx(Oe,{className:"ml-1 h-3 w-3"})]})}),r&&o.length>l&&t.jsx(I,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>a(!1),children:t.jsxs("span",{className:"flex items-center",children:["Show Less ",t.jsx(Me,{className:"ml-1 h-3 w-3"})]})}),u.length>0&&t.jsxs(Wt,{open:s,onOpenChange:n,className:"mt-3",children:[t.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[t.jsx("div",{className:"h-px bg-border flex-grow mr-2"}),t.jsx(qt,{asChild:!0,children:t.jsxs("button",{className:"flex items-center gap-1 px-2 py-1 rounded-sm hover:bg-muted/50 transition-colors",children:[t.jsxs("span",{children:["Former Members (",u.length,")"]}),s?t.jsx(Me,{className:"h-3 w-3"}):t.jsx(Oe,{className:"h-3 w-3"})]})}),t.jsx("div",{className:"h-px bg-border flex-grow ml-2"})]}),t.jsx(Zt,{className:"pt-2",children:t.jsx("div",{className:"space-y-1.5",children:w.map(i=>t.jsx("div",{children:t.jsxs("div",{className:"relative flex items-center justify-between group py-1.5",children:[t.jsx("div",{className:"absolute inset-0 rounded-md bg-muted/30 pointer-events-none"}),t.jsxs("div",{className:"flex items-center gap-2 z-10",children:[t.jsxs("div",{className:"relative",children:[t.jsx(_e,{className:"h-7 w-7",children:i.user?.image?t.jsx("img",{src:i.user.image,alt:i.user?.name||"User",className:"filter grayscale"}):t.jsx("div",{className:"bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 text-xs",children:(i.user?.name||"U").charAt(0)})}),t.jsx("div",{className:"absolute -bottom-1 -right-1 rounded-full w-3 h-3 bg-muted border border-background flex items-center justify-center",children:t.jsx("span",{className:"text-[8px]",children:"Ã—"})})]}),t.jsx(ge,{children:t.jsxs(je,{children:[t.jsx(ve,{asChild:!0,children:t.jsx("span",{className:"text-sm font-medium truncate max-w-[120px] text-muted-foreground",children:i.user?.name||"Unknown User"})}),t.jsxs(ye,{children:[t.jsx("p",{children:i.user?.name||"Unknown User"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:i.user?.email}),t.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No longer a member"})]})]})})]}),t.jsx(Se,{className:`${st(i.role)} opacity-70`,children:i.role})]})},i.id))})})]})]})},Is=function(){const{projectId:r}=Ue.useParams(),[a,s]=f.useState(!1),[n,l]=f.useState(!0),[d,o]=f.useState(""),[u,N]=f.useState(""),[P,w]=f.useState(!1),[E,m]=f.useState(!1),[i,F]=f.useState(null),[j,k]=f.useState(!1),[S,M]=Lt(it),L=nt(zt),A=Ue.useRouteContext(),[D]=f.useState(A.userId),g=S.flatMap(c=>c.projects||[]).find(c=>c.id===r),h=S.find(c=>c.id===g?.teamspaceId);f.useEffect(()=>{g&&(l(!1),console.log("files",g.files))},[g]);const C=at();if(n)return t.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[t.jsx("div",{className:"h-1.5 bg-gray-200 w-full"}),t.jsxs("div",{className:"p-6 max-w-5xl mx-auto w-full flex-1",children:[t.jsxs("div",{className:"mb-8 relative",children:[t.jsx(V,{className:"h-10 w-60 mb-2"}),t.jsx(V,{className:"h-4 w-full max-w-md mb-4"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"md:col-span-2 space-y-6",children:[t.jsx("div",{children:t.jsx(V,{className:"h-32 w-full mb-6"})}),t.jsxs("div",{children:[t.jsx("div",{className:"flex justify-between items-center mb-4",children:t.jsx(V,{className:"h-8 w-40"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(V,{className:"h-16 w-full"}),t.jsx(V,{className:"h-16 w-full"})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsx(V,{className:"h-60 w-full"}),t.jsx(V,{className:"h-60 w-full"})]})]})]})]});if(!g)return t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Project not found"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:"The project you're looking for doesn't exist or you don't have access to it."}),h?t.jsx(I,{variant:"outline",asChild:!0,children:t.jsx(ae,{to:"/teamspace/$teamspaceId",params:{teamspaceId:h.id},children:"Back to Teamspace"})}):t.jsx(I,{variant:"outline",asChild:!0,children:t.jsx(ae,{to:"/chat",children:"Go to Chat"})})]});const R=async(c="")=>{if(a)return;s(!0);const v=$e({currentUserId:D,project:g,teamspace:h});try{const{data:y}=await z().chatrooms.createChatroom({chatroomCreatorId:D,chatroomMembers:v,isPrivate:!1,projectId:g.id,name:c.trim()||"New Chat Conversation",teamIds:[],type:"PROJECT_CHATROOM"});g.chatrooms?.push(y),L(y),C({to:"/chat/$chatroomId",params:{chatroomId:y.id}})}catch(y){console.error("Error creating chatroom:",y)}finally{s(!1),m(!1),N("")}},p=async()=>{if(!(!d.trim()||a))try{s(!0);const c=$e({currentUserId:D,project:g,teamspace:h}),{data:v}=await z().chatrooms.createChatroom({chatroomCreatorId:D,chatroomMembers:c,isPrivate:!1,projectId:g.id,name:"New Chat Conversation",teamIds:[],type:"PROJECT_CHATROOM"});g.chatrooms?.push(v),localStorage.setItem("pendingMessage",d),L(v),C({to:"/chat/$chatroomId",params:{chatroomId:v.id}})}catch(c){console.error("Error starting quick chat:",c),s(!1)}},x=c=>{const v=S.map(y=>y.id===h?.id?{...y,projects:y.projects?.map(T=>T.id===g?.id?c:T)}:y);M(v)},b=async c=>{if(!(!c.id||j))try{k(!0),await z().chatrooms.deleteOneProjectFile({fileId:c.id,projectId:g.id}),M(v=>v.map(y=>y.id===h?.id?{...y,projects:y.projects?.map(T=>T.id===g?.id?{...T,files:T.files?.filter(Z=>Z.id!==c.id)}:T)}:y))}catch(v){console.error("Error deleting file:",v)}finally{k(!1),F(null)}};return t.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[t.jsx("div",{className:"h-1.5 bg-emerald-500 w-full flex-shrink-0"}),t.jsxs("div",{className:"p-6 max-w-5xl mx-auto w-full flex-1 overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mb-4",children:[t.jsxs(ae,{to:"/chat",className:"flex items-center hover:text-foreground transition-colors",children:[t.jsx(Ht,{className:"h-3.5 w-3.5 mr-1"}),"Home"]}),h&&t.jsxs(t.Fragment,{children:[t.jsx(Le,{className:"h-3.5 w-3.5 mx-1.5"}),t.jsxs(ae,{to:"/teamspace/$teamspaceId",params:{teamspaceId:h.id},className:"flex items-center hover:text-foreground transition-colors",children:[t.jsx(Ve,{className:"h-3.5 w-3.5 mr-1.5"}),h.name]})]}),t.jsx(Le,{className:"h-3.5 w-3.5 mx-1.5"}),t.jsxs("span",{className:"font-medium text-foreground flex items-center",children:[t.jsx(Be,{className:"h-3.5 w-3.5 mr-1.5"}),"Project"]})]}),t.jsxs("div",{className:"mb-8 relative",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-emerald-100 text-emerald-700",children:t.jsx(Be,{className:"h-5 w-5"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:g.name}),t.jsxs("div",{className:"flex items-center mt-1",children:[t.jsx("span",{className:"inline-flex items-center rounded-md bg-emerald-50 px-2 py-1 text-xs font-medium text-emerald-700 ring-1 ring-inset ring-emerald-600/20",children:"Project"}),g.isPrivate&&t.jsxs("span",{className:"ml-2 inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-700 ring-1 ring-inset ring-gray-600/20",children:[t.jsx(ie,{className:"h-3 w-3 mr-1"}),"Private"]}),h&&t.jsxs("span",{className:"ml-2 text-sm text-muted-foreground flex items-center",children:[t.jsx(Ve,{className:"h-3 w-3 mr-1"}),h.name]})]})]})]}),t.jsx("div",{className:"mt-2",children:t.jsx("p",{className:"text-muted-foreground",children:g.description||"No description provided"})}),t.jsx("div",{className:"absolute top-0 right-0",children:t.jsx(sr,{project:g,userId:D,onProjectUpdated:x})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"md:col-span-2 space-y-6",children:[t.jsxs(H,{className:"border-b-4 border-b-emerald-500",children:[t.jsxs(G,{className:"pb-3",children:[t.jsx(K,{children:"New chat in this project"}),t.jsx(ne,{children:"Start a new conversation in the context of this project"})]}),t.jsx(X,{children:t.jsxs($t,{value:d,onChange:c=>o(c.target.value),onSubmit:p,hasMessages:!1,children:[t.jsx(_t,{placeholder:a?"Creating chat...":"Type a message to start a new chat...",disabled:a,onKeyDown:c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),p())}}),t.jsx(Vt,{disabled:a||!d.trim()})]})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Chats in this project"}),E?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",className:"px-3 py-1 border rounded-md text-sm",placeholder:"Chatroom name...",value:u,onChange:c=>N(c.target.value),onKeyDown:c=>{c.key==="Enter"?R(u):c.key==="Escape"&&(m(!1),N(""))},autoFocus:!0}),t.jsx(I,{size:"sm",onClick:()=>R(u),disabled:a,className:"bg-emerald-600 hover:bg-emerald-700 text-white hover:cursor-pointer",children:"Create"}),t.jsx(I,{size:"sm",variant:"ghost",onClick:()=>{m(!1),N("")},className:"hover:cursor-pointer",children:"Cancel"})]}):t.jsxs(I,{size:"sm",onClick:()=>m(!0),disabled:a,className:"bg-emerald-600 hover:bg-emerald-700 text-white hover:cursor-pointer",children:[t.jsx(qe,{className:"h-4 w-4 mr-2"})," New Chat"]})]}),g.chatrooms&&g.chatrooms.length>0?t.jsx("div",{className:"space-y-3",children:g.chatrooms.map(c=>t.jsx(H,{className:Q("cursor-pointer transition-all border-l-4 border-l-transparent","hover:shadow-md hover:border-l-emerald-500 hover:bg-muted/30"),onClick:()=>{L(c),C({to:"/chat"})},children:t.jsx(G,{className:"py-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(K,{className:"text-base flex items-center",children:[t.jsx(Xt,{className:"h-4 w-4 mr-2"}),c.name,c.isPrivate&&t.jsx(ge,{children:t.jsxs(je,{children:[t.jsx(ve,{asChild:!0,children:t.jsx("span",{children:t.jsx(ie,{className:"h-3 w-3 ml-2 text-red-500"})})}),t.jsx(ye,{children:t.jsx("p",{children:"Private"})})]})})]}),t.jsx("div",{className:"flex items-center gap-3 text-muted-foreground text-xs",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(ze,{className:"h-3 w-3 mr-1"}),c.members?.length||1]})})]})})},c.id))}):t.jsxs("div",{className:"border rounded-lg p-8 text-center bg-muted/20",children:[t.jsx("h3",{className:"font-medium mb-2",children:"No chats yet"}),t.jsx("p",{className:"text-muted-foreground mb-4",children:"Start by creating your first chat in this project"}),t.jsxs(I,{variant:"outline",onClick:()=>m(!0),className:"border-emerald-600/20 text-emerald-700 hover:bg-emerald-50",children:[t.jsx(qe,{className:"h-4 w-4 mr-2"})," Create Chat"]})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(H,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(G,{children:[t.jsxs(K,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"Project Context"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:cursor-pointer",onClick:()=>w(!P),children:t.jsx(lt,{className:"h-4 w-4"})})]}),t.jsx(ne,{children:"Information about this project's purpose"})]}),t.jsx(X,{children:P?t.jsxs("div",{className:"space-y-4",children:[t.jsx("textarea",{className:"w-full min-h-[150px] p-3 border rounded-md",placeholder:"Describe what this teamspace is used for...",value:g.context}),t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx(I,{variant:"outline",size:"sm",onClick:()=>w(!1),children:"Cancel"}),t.jsx(I,{size:"sm",onClick:()=>w(!1),children:"Save"})]})]}):t.jsx("div",{className:"text-sm",children:t.jsx("p",{children:g.context})})})]}),t.jsxs(H,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(G,{children:[t.jsx(K,{children:"Members"}),t.jsx(ne,{children:"People with access to this project"})]}),t.jsx(X,{children:g.members&&g.members.length>0?t.jsx(ps,{members:g.members}):t.jsx("div",{className:"text-sm text-muted-foreground",children:"Only you have access to this project"})}),t.jsx(Bt,{children:t.jsx(Gt,{type:"project",projectId:g.id,teamspaceId:g.teamspaceId,members:g.members||[],userId:D,onMembersChanged:()=>{z().chatrooms.getTeamspaces().then(({data:c})=>{c&&M(c)})},children:t.jsxs(I,{size:"sm",variant:"outline",className:"w-full border-emerald-600/20 text-emerald-700 hover:bg-emerald-50 hover:cursor-pointer",children:[t.jsx(ze,{className:"h-4 w-4 mr-2"})," Manage Members"]})})})]}),t.jsxs(H,{className:"border-t-4 border-t-emerald-500",children:[t.jsx(G,{children:t.jsx(K,{children:"Project Stats"})}),t.jsx(X,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Chats"}),t.jsx("span",{className:"font-medium",children:g.chatrooms?.length||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Members"}),t.jsx("span",{className:"font-medium",children:g.members?.length||1})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Files"}),t.jsx("span",{className:"font-medium",children:g.files?.length||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Created"}),t.jsx("span",{className:"font-medium",children:new Date(g.createdAt).toLocaleDateString()})]}),g.isPrivate&&t.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t",children:[t.jsxs("span",{className:"text-muted-foreground flex items-center",children:[t.jsx(ie,{className:"h-3.5 w-3.5 mr-1.5 text-red-500"}),"Visibility"]}),t.jsx("span",{className:"font-medium text-sm bg-gray-100 px-2 py-0.5 rounded",children:"Private"})]})]})})]}),t.jsxs(H,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(G,{className:"pb-2",children:[t.jsxs(K,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"Project Files"}),g.files&&g.files.length>0&&t.jsx(rt,{teamspaceId:h?.id,projectId:g.id,organizationId:A.session?.activeOrganizationId||"",compact:!0,files:g.files||[],className:"ml-auto",onUploadComplete:c=>{console.log("Files uploaded successfully",c),z().chatrooms.getProject(g.id).then(({data:v})=>{v&&M(y=>y.map(T=>T.id===h?.id?{...T,projects:T.projects?.map(Z=>Z.id===g.id?v:Z)}:T))}).catch(v=>{console.error("Error refreshing project data:",v)})}})]}),t.jsx(ne,{children:"Upload and manage files for this project"})]}),t.jsx(X,{children:g.files&&g.files.length>0?t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-1",children:g.files.map((c,v)=>t.jsxs("div",{className:"flex items-center p-2 border rounded bg-white hover:bg-gray-50 transition-colors",children:[t.jsx("div",{className:"w-10 h-10 mr-3 bg-gray-100 flex items-center justify-center rounded overflow-hidden flex-shrink-0",children:hs(c)}),t.jsxs("div",{className:"flex-1 truncate",children:[t.jsx("a",{href:c.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm truncate hover:underline hover:text-emerald-600",title:c.fileName,children:c.fileName||`File ${v+1}`}),t.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(c.createdAt).toLocaleDateString()})]}),t.jsx(I,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700 hover:bg-red-50",onClick:y=>{y.preventDefault(),y.stopPropagation(),F(c)},children:t.jsx(ue,{className:"h-4 w-4"})})]},c.id||v))}):t.jsxs("div",{className:"text-center py-8 bg-muted/10 rounded-lg border border-dashed min-h-[160px] flex flex-col items-center justify-center",children:[t.jsx("div",{className:"bg-gray-50 p-4 rounded-full mb-3",children:t.jsx(me,{className:"h-8 w-8 text-emerald-600"})}),t.jsx("p",{className:"text-base font-medium text-gray-700 mb-1",children:"No files uploaded yet"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Add files to this project"}),t.jsx(rt,{teamspaceId:h?.id,projectId:g.id,organizationId:A.session?.activeOrganizationId||"",onUploadComplete:c=>{console.log("Files uploaded successfully",c),z().chatrooms.getProject(g.id).then(({data:v})=>{v&&M(y=>y.map(T=>T.id===h?.id?{...T,projects:T.projects?.map(Z=>Z.id===g.id?v:Z)}:T))}).catch(v=>{console.error("Error refreshing project data:",v)})}})]})})]})]})]})]}),t.jsx(Ee,{open:!!i,onOpenChange:c=>!c&&F(null),children:t.jsxs(Ie,{children:[t.jsxs(ce,{children:[t.jsxs(de,{className:"flex items-center",children:[t.jsx(dt,{className:"h-5 w-5 text-red-500 mr-2"}),"Delete File"]}),t.jsxs(Ne,{children:["Are you sure you want to delete ",t.jsx("span",{className:"font-medium",children:i?.fileName}),"? This action cannot be undone."]})]}),t.jsxs(ct,{children:[t.jsx(I,{variant:"outline",onClick:()=>F(null),disabled:j,children:"Cancel"}),t.jsx(I,{variant:"destructive",onClick:()=>i&&b(i),className:"bg-red-600 hover:bg-red-700 text-white",disabled:j,children:j?"Deleting...":"Delete"})]})]})})]})};export{Is as component};

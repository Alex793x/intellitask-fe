import{l as ge,j as e,y as A,r as c,b2 as he,b3 as z,b4 as K,a4 as q,P as R,b5 as Q,b6 as xe,b7 as pe,b8 as E,b9 as X,aa as ve,ab as Ne,B as P,U as Ce,g as je,af as ye,ag as we,X as Te,ae as Re,k as T,ba as Me,bb as Ie}from"./client-uXE92eGo.js";import{D as Le,a as Ae,b as Se,c as Pe,d as Ee,e as _e,f as ke}from"./dialog-CjqjsqEA.js";import{S as De,A as Oe}from"./avatar-CwKHsdmf.js";import{P as $e}from"./plus-CIdEaKGf.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],ss=ge("House",Fe);function ts({className:s,...r}){return e.jsx("div",{"data-slot":"skeleton",className:A("bg-primary/10 animate-pulse rounded-md",s),...r})}var V="Tabs",[Ve,as]=K(V,[Q]),J=Q(),[Be,B]=Ve(V),Y=c.forwardRef((s,r)=>{const{__scopeTabs:n,value:l,onValueChange:o,defaultValue:u,orientation:d="horizontal",dir:b,activationMode:h="automatic",...g}=s,f=he(b),[m,x]=z({prop:l,onChange:o,defaultProp:u});return e.jsx(Be,{scope:n,baseId:q(),value:m,onValueChange:x,orientation:d,dir:f,activationMode:h,children:e.jsx(R.div,{dir:f,"data-orientation":d,...g,ref:r})})});Y.displayName=V;var Z="TabsList",ee=c.forwardRef((s,r)=>{const{__scopeTabs:n,loop:l=!0,...o}=s,u=B(Z,n),d=J(n);return e.jsx(xe,{asChild:!0,...d,orientation:u.orientation,dir:u.dir,loop:l,children:e.jsx(R.div,{role:"tablist","aria-orientation":u.orientation,...o,ref:r})})});ee.displayName=Z;var se="TabsTrigger",te=c.forwardRef((s,r)=>{const{__scopeTabs:n,value:l,disabled:o=!1,...u}=s,d=B(se,n),b=J(n),h=ne(d.baseId,l),g=oe(d.baseId,l),f=l===d.value;return e.jsx(pe,{asChild:!0,...b,focusable:!o,active:f,children:e.jsx(R.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":g,"data-state":f?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:h,...u,ref:r,onMouseDown:E(s.onMouseDown,m=>{!o&&m.button===0&&m.ctrlKey===!1?d.onValueChange(l):m.preventDefault()}),onKeyDown:E(s.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&d.onValueChange(l)}),onFocus:E(s.onFocus,()=>{const m=d.activationMode!=="manual";!f&&!o&&m&&d.onValueChange(l)})})})});te.displayName=se;var ae="TabsContent",re=c.forwardRef((s,r)=>{const{__scopeTabs:n,value:l,forceMount:o,children:u,...d}=s,b=B(ae,n),h=ne(b.baseId,l),g=oe(b.baseId,l),f=l===b.value,m=c.useRef(f);return c.useEffect(()=>{const x=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(x)},[]),e.jsx(X,{present:o||f,children:({present:x})=>e.jsx(R.div,{"data-state":f?"active":"inactive","data-orientation":b.orientation,role:"tabpanel","aria-labelledby":h,hidden:!x,id:g,tabIndex:0,...d,ref:r,style:{...s.style,animationDuration:m.current?"0s":void 0},children:x&&u})})});re.displayName=ae;function ne(s,r){return`${s}-trigger-${r}`}function oe(s,r){return`${s}-content-${r}`}var Ue=Y,ie=ee,le=te,ce=re;const Ge=Ue,de=c.forwardRef(({className:s,...r},n)=>e.jsx(ie,{ref:n,className:A("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...r}));de.displayName=ie.displayName;const $=c.forwardRef(({className:s,...r},n)=>e.jsx(le,{ref:n,className:A("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...r}));$.displayName=le.displayName;const F=c.forwardRef(({className:s,...r},n)=>e.jsx(ce,{ref:n,className:A("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r}));F.displayName=ce.displayName;function rs(s){const[r,n]=c.useState(!1),[l,o]=c.useState("current"),[u,d]=c.useState(""),[b,h]=c.useState(!1),g=ve(Ne),m=[...s.type==="teamspace"?s.members.filter(t=>t.user?.name?.toLowerCase().includes(u.toLowerCase())||t.user?.email?.toLowerCase().includes(u.toLowerCase())).filter((t,a,i)=>a===i.findIndex(v=>v.user?.id===t.user?.id)):s.members.filter(t=>t.user?.name?.toLowerCase().includes(u.toLowerCase())||t.user?.email?.toLowerCase().includes(u.toLowerCase())).filter((t,a,i)=>a===i.findIndex(v=>v.user?.id===t.user?.id))].sort((t,a)=>{if(t.hasLeft!==a.hasLeft)return t.hasLeft?1:-1;const i={OWNER:0,ADMIN:1,CONTRIBUTOR:2,VIEWER:3};return(i[t.role]||4)-(i[a.role]||4)}),x=t=>{switch(t){case"OWNER":return"bg-green-100 text-green-800 border-green-200";case"ADMIN":return"bg-red-100 text-red-800 border-red-200";case"CONTRIBUTOR":return"bg-blue-100 text-blue-800 border-blue-200";case"VIEWER":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},S=async t=>{if(!b){h(!0);try{const a=Re();if(s.type==="teamspace"){const i=s.members.find(y=>y.id===t);if(!i){T.error("Member not found");return}const v=i.hasLeft;await a.chatrooms.changeTeamspaceMemberStatus(s.teamspaceId,t,{kickStatus:!v}),g(y=>y.map(p=>{if(p.id===s.teamspaceId){const k=p.members?.map(N=>N.id===t?{...N,hasLeft:!i.hasLeft}:N)||[],w=p.projects?.map(N=>{const D=N.members?.map(j=>j.user?.id===i.user?.id?{...j,hasLeft:!i.hasLeft}:j)||[],C=N.chatrooms?.map(j=>{const L=j.members?.map(O=>O.user?.id===i.user?.id?{...O,hasLeft:!i.hasLeft}:O)||[];return{...j,members:L}})||[];return{...N,members:D,chatrooms:C}})||[];return{...p,members:k,projects:w}}return p})),v?T.success("Member re-invited successfully"):T.success("Member removed successfully")}else{const i=s.members.find(y=>y.id===t);if(!i){T.error("Member not found");return}const v=i.hasLeft;await a.chatrooms.changeProjectMemberStatus(s.projectId,t,{kickStatus:!v}),g(y=>y.map(p=>{if(p.id===s.teamspaceId){const k=p.projects?.map(w=>{if(w.id===s.projectId){const N=w.members?.map(C=>C.id===t?{...C,hasLeft:!i.hasLeft}:C)||[],D=w.chatrooms?.map(C=>{const j=C.members?.map(L=>L.user?.id===i.user?.id?{...L,hasLeft:!i.hasLeft}:L)||[];return{...C,members:j}})||[];return{...w,members:N,chatrooms:D}}return w})||[];return{...p,projects:k}}return p})),setTimeout(()=>n(!1),500),v?T.success("Member re-invited successfully"):T.success("Member removed successfully")}}catch(a){console.error("Error updating member status:",a),T.error("Failed to update member status")}finally{h(!1)}}},M=(()=>{const{userId:t}=s;if(s.type==="teamspace"){const a=s.members.find(i=>i.user.id===t);return a?.role==="OWNER"||a?.role==="ADMIN"}else{const a=s.members.find(i=>i.user.id===t);return a?.role==="OWNER"||a?.role==="ADMIN"}})(),I=t=>{const a=t.hasLeft;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:`h-8 w-8 ${a?"opacity-50":""}`,children:t.user?.image?e.jsx("img",{src:t.user.image,alt:t.user?.name||"User",className:a?"grayscale":""}):e.jsx("div",{className:`bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 ${a?"bg-gray-100":""}`,children:(t.user?.name||"U").charAt(0)})}),e.jsxs("div",{children:[e.jsxs("div",{className:`font-medium flex items-center ${a?"text-muted-foreground":""}`,children:[t.user?.name||"Unknown User",a&&e.jsx("span",{className:"ml-2 text-xs px-1.5 py-0.5 rounded bg-gray-100 text-gray-500",children:"Left"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.user?.email||""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:`${x(t.role)} ${a?"opacity-50":""}`,children:t.role}),M&&t.user.id!==s.userId&&e.jsx(P,{variant:a?"outline":"ghost",size:"icon",disabled:b,onClick:()=>S(t.id),className:`h-8 w-8 ${a?"border-green-200 hover:bg-green-50 hover:text-green-700":""}`,title:a?"Re-invite member":"Remove member",children:a?e.jsx($e,{className:"h-4 w-4 text-green-600"}):e.jsx(Te,{className:"h-4 w-4"})})]})]},t.id)};return e.jsxs(Le,{open:r,onOpenChange:n,children:[e.jsx(Ae,{asChild:!0,children:s.children||e.jsxs(P,{size:"sm",variant:"outline",className:"w-full border-indigo-600/20 text-indigo-700 hover:bg-indigo-50",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"})," Manage Members"]})}),e.jsxs(Se,{className:"sm:max-w-[550px]",children:[e.jsxs(Pe,{children:[e.jsxs(Ee,{children:["Manage ",s.type==="teamspace"?"Teamspace":"Project"," Members"]}),e.jsxs(_e,{children:["View and manage who has access to this ",s.type]})]}),e.jsxs(Ge,{defaultValue:"current",value:l,onValueChange:o,className:"mt-4",children:[e.jsxs(de,{className:"grid w-full grid-cols-2",children:[e.jsx($,{value:"current",children:"Current Members"}),e.jsx($,{value:"invite",disabled:!M,children:"Invite Members"})]}),e.jsxs(F,{value:"current",className:"mt-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(je,{type:"text",placeholder:"Search members...",className:"pl-8",value:u,onChange:t=>d(t.target.value)})]})}),e.jsx(ye,{className:"h-[320px] rounded-md border p-4",children:e.jsx("div",{className:"space-y-4",children:m.length>0?e.jsxs(e.Fragment,{children:[m.some(t=>!t.hasLeft)&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Active Members"}),e.jsx("div",{className:"space-y-3",children:m.filter(t=>!t.hasLeft).map(I)})]}),m.some(t=>t.hasLeft)&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"mb-2 flex items-center text-xs text-muted-foreground",children:[e.jsx("div",{className:"h-px bg-border flex-grow mr-2"}),e.jsx("span",{children:"Former Members"}),e.jsx("div",{className:"h-px bg-border flex-grow ml-2"})]}),e.jsx("div",{className:"space-y-3 mt-3",children:m.filter(t=>t.hasLeft).map(I)})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No members found"})})})]}),e.jsx(F,{value:"invite",className:"mt-4",children:e.jsxs("div",{className:"bg-muted/40 rounded-md p-8 text-center",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Invite Members"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"This feature is coming soon"}),e.jsx(P,{variant:"outline",onClick:()=>o("current"),children:"Back to Current Members"})]})})]}),e.jsx(ke,{children:e.jsx(P,{variant:"outline",onClick:()=>n(!1),children:"Close"})})]})]})}var U="Collapsible",[He,ns]=K(U),[We,G]=He(U),ue=c.forwardRef((s,r)=>{const{__scopeCollapsible:n,open:l,defaultOpen:o,disabled:u,onOpenChange:d,...b}=s,[h=!1,g]=z({prop:l,defaultProp:o,onChange:d});return e.jsx(We,{scope:n,disabled:u,contentId:q(),open:h,onOpenToggle:c.useCallback(()=>g(f=>!f),[g]),children:e.jsx(R.div,{"data-state":W(h),"data-disabled":u?"":void 0,...b,ref:r})})});ue.displayName=U;var me="CollapsibleTrigger",fe=c.forwardRef((s,r)=>{const{__scopeCollapsible:n,...l}=s,o=G(me,n);return e.jsx(R.button,{type:"button","aria-controls":o.contentId,"aria-expanded":o.open||!1,"data-state":W(o.open),"data-disabled":o.disabled?"":void 0,disabled:o.disabled,...l,ref:r,onClick:E(s.onClick,o.onOpenToggle)})});fe.displayName=me;var H="CollapsibleContent",be=c.forwardRef((s,r)=>{const{forceMount:n,...l}=s,o=G(H,s.__scopeCollapsible);return e.jsx(X,{present:n||o.open,children:({present:u})=>e.jsx(ze,{...l,ref:r,present:u})})});be.displayName=H;var ze=c.forwardRef((s,r)=>{const{__scopeCollapsible:n,present:l,children:o,...u}=s,d=G(H,n),[b,h]=c.useState(l),g=c.useRef(null),f=Me(r,g),m=c.useRef(0),x=m.current,S=c.useRef(0),_=S.current,M=d.open||b,I=c.useRef(M),t=c.useRef(void 0);return c.useEffect(()=>{const a=requestAnimationFrame(()=>I.current=!1);return()=>cancelAnimationFrame(a)},[]),Ie(()=>{const a=g.current;if(a){t.current=t.current||{transitionDuration:a.style.transitionDuration,animationName:a.style.animationName},a.style.transitionDuration="0s",a.style.animationName="none";const i=a.getBoundingClientRect();m.current=i.height,S.current=i.width,I.current||(a.style.transitionDuration=t.current.transitionDuration,a.style.animationName=t.current.animationName),h(l)}},[d.open,l]),e.jsx(R.div,{"data-state":W(d.open),"data-disabled":d.disabled?"":void 0,id:d.contentId,hidden:!M,...u,ref:f,style:{"--radix-collapsible-content-height":x?`${x}px`:void 0,"--radix-collapsible-content-width":_?`${_}px`:void 0,...s.style},children:M&&o})});function W(s){return s?"open":"closed"}var Ke=ue,qe=fe,Qe=be;const os=Ke,is=qe,Xe=c.forwardRef(({className:s,...r},n)=>e.jsx(Qe,{ref:n,className:A("overflow-hidden transition-all duration-300 ease-in-out",s),...r}));Xe.displayName="CollapsibleContent";export{os as C,ss as H,rs as M,ts as S,is as a,Xe as b};
